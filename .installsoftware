#!/bin/bash

source ~/.functions

install-jdk(){

  VERSION_JAVA_EIGHT_ADOPTIUM_TAG=$VERSION_JAVA_EIGHT
  VERSION_JAVA_EIGHT_ADOPTIUM_ARCHIVE_NAME="OpenJDK8U-jdk_x64_linux_hotspot_8u362b09.tar.gz"

  VERSION_JAVA_ELEVEN_ADOPTIUM_TAG=$( eval "rawurlencode $VERSION_JAVA_ELEVEN")
  VERSION_JAVA_ELEVEN_ADOPTIUM_ARCHIVE_NAME="OpenJDK11U-jdk_x64_linux_hotspot_11.0.18_10.tar.gz"

  VERSION_JAVA_SEVENTEEN_ADOPTIUM_TAG=$( eval "rawurlencode $VERSION_JAVA_SEVENTEEN")
  VERSION_JAVA_SEVENTEEN_ADOPTIUM_ARCHIVE_NAME="OpenJDK17U-jdk_x64_linux_hotspot_17.0.6_10.tar.gz"

  VERSION_JAVA_EIGHTEEN_ADOPTIUM_TAG=$( eval "rawurlencode $VERSION_JAVA_EIGHTEEN")
  VERSION_JAVA_EIGHTEEN_ADOPTIUM_ARCHIVE_NAME="OpenJDK18U-jdk_x64_linux_hotspot_18.0.2.1_1.tar.gz"

  VERSION_JAVA_NINETEEN_ADOPTIUM_TAG=$( eval "rawurlencode $VERSION_JAVA_NINETEEN")
  VERSION_JAVA_NINETEEN_ADOPTIUM_ARCHIVE_NAME="OpenJDK19U-jdk_x64_linux_hotspot_19.0.2_7.tar.gz"

  JDK_VERSION=$1

  echo "JDK_VERSION : $JDK_VERSION"

  case $JDK_VERSION in
    19)
      # https://github.com/adoptium/temurin19-binaries
      ADOPTIUM_TOP_VERSION=19
      ADOPTIUM_TAG_VERSION=$VERSION_JAVA_NINETEEN_ADOPTIUM_TAG
      ADOPTIUM_FOLDER=$VERSION_JAVA_NINETEEN
      ADOPTIUM_ARCHIVE_NAME=$VERSION_JAVA_NINETEEN_ADOPTIUM_ARCHIVE_NAME
    ;;

    18)
      # https://github.com/adoptium/temurin18-binaries
      ADOPTIUM_TOP_VERSION=18
      ADOPTIUM_TAG_VERSION=$VERSION_JAVA_EIGHTEEN_ADOPTIUM_TAG
      ADOPTIUM_FOLDER=$VERSION_JAVA_EIGHTEEN
      ADOPTIUM_ARCHIVE_NAME=$VERSION_JAVA_EIGHTEEN_ADOPTIUM_ARCHIVE_NAME
    ;;

    17)
      # https://github.com/adoptium/temurin17-binaries
      ADOPTIUM_TOP_VERSION=17
      ADOPTIUM_TAG_VERSION=$VERSION_JAVA_SEVENTEEN_ADOPTIUM_TAG
      ADOPTIUM_FOLDER=$VERSION_JAVA_SEVENTEEN
      ADOPTIUM_ARCHIVE_NAME=$VERSION_JAVA_SEVENTEEN_ADOPTIUM_ARCHIVE_NAME
    ;;

    11)
      # https://github.com/adoptium/temurin11-binaries
      ADOPTIUM_TOP_VERSION=11
      ADOPTIUM_TAG_VERSION=$VERSION_JAVA_ELEVEN_ADOPTIUM_TAG
      ADOPTIUM_FOLDER=$VERSION_JAVA_ELEVEN
      ADOPTIUM_ARCHIVE_NAME=$VERSION_JAVA_ELEVEN_ADOPTIUM_ARCHIVE_NAME
    ;;

    8)
      # https://github.com/adoptium/temurin8-binaries
      ADOPTIUM_TOP_VERSION=8
      ADOPTIUM_TAG_VERSION=$VERSION_JAVA_EIGHT_ADOPTIUM_TAG
      ADOPTIUM_FOLDER=$VERSION_JAVA_EIGHT
      ADOPTIUM_ARCHIVE_NAME=$VERSION_JAVA_EIGHT_ADOPTIUM_ARCHIVE_NAME
    ;;

    *)
      ADOPTIUM_TOP_VERSION=17
      ADOPTIUM_TAG_VERSION=$VERSION_JAVA_SEVENTEEN_ADOPTIUM_TAG
      ADOPTIUM_FOLDER=$VERSION_JAVA_SEVENTEEN
      ADOPTIUM_ARCHIVE_NAME=$VERSION_JAVA_SEVENTEEN_ADOPTIUM_ARCHIVE_NAME
    ;;
  esac

  JAVA_INSTALL_DIR="/opt/java"
  JDK_BASE_URL="https://github.com/adoptium/temurin"$ADOPTIUM_TOP_VERSION"-binaries/releases/download/$ADOPTIUM_TAG_VERSION/$ADOPTIUM_ARCHIVE_NAME"

  JDK_ARCHIVE_PATH="$SOFTWARE_FOLDER/$ADOPTIUM_ARCHIVE_NAME"

  echo "ADOPTIUM_ARCHIVE_NAME : $ADOPTIUM_ARCHIVE_NAME"
  echo "JDK_ARCHIVE_PATH : $JDK_ARCHIVE_PATH"

  if [ ! -f "$JDK_ARCHIVE_PATH" ]; then
    wget -P $SOFTWARE_FOLDER $JDK_BASE_URL
  fi

  if [ ! -d "$JAVA_INSTALL_DIR" ]; then
    sudo mkdir -p $JAVA_INSTALL_DIR
    sudo chown $LOGNAME:$LOGNAME -R $JAVA_INSTALL_DIR
    echo "Folder $JAVA_INSTALL_DIR was created"
  else
    echo "Folder $JAVA_INSTALL_DIR already existed"
  fi

  if [ ! -d "$JAVA_INSTALL_DIR/$ADOPTIUM_FOLDER" ]; then
    tar -xzf $JDK_ARCHIVE_PATH -C $JAVA_INSTALL_DIR
  else
    echo "$ADOPTIUM_FOLDER is already installed"
  fi

  echo "Java install in the folder $ADOPTIUM_FOLDER"

}

install-jdk8(){
  echo "Starting to install jdk 8"
  install-jdk 8
}

install-jdk11(){
  echo "Starting to install jdk 11"
  install-jdk 11
}

install-jdk17(){
  echo "Starting to install jdk 17"
  install-jdk 17
}

install-jdk18(){
  echo "Starting to install jdk 18"
  install-jdk 18
}

install-jdk19(){
  echo "Starting to install jdk 19"
  install-jdk 19
}

