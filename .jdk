#!/bin/bash

jdk8(){
	export JAVA_HOME=$JAVA_EIGHT_HOME
	updateJdkAlternatives
	echo "== Switching to Java 8 -> JAVA_HOME : $JAVA_HOME"
}

jdk11(){
	export JAVA_HOME=$JAVA_ELEVEN_HOME
	updateJdkAlternatives
	echo "== Switching to Java 11 -> JAVA_HOME : $JAVA_HOME"
}

jdk17(){
	export JAVA_HOME=$JAVA_SEVENTEEN_HOME
	updateJdkAlternatives
	echo "== Switching to Java 17 -> JAVA_HOME : $JAVA_HOME"
}

jdk18(){
	export JAVA_HOME=$JAVA_EIGHTEEN_HOME
	updateJdkAlternatives
	echo "== Switching to Java 18 -> JAVA_HOME : $JAVA_HOME"
}

jdk19(){
	export JAVA_HOME=$JAVA_NINETEEN_HOME
	updateJdkAlternatives
	echo "== Switching to Java 19 -> JAVA_HOME : $JAVA_HOME"
}


jdkNext(){
	export JAVA_HOME=$JAVA_NEXT_HOME
	updateJdkAlternatives
	echo "== Switching to Java Next -> JAVA_HOME : $JAVA_HOME"
}

jdkGetReadyToBuild(){
	sudo dnf install freetype-devel \
		cups-devel \
		libXtst-devel \
		libXt-devel \
		libXrender-devel \
		libXrandr-devel \
		libXi-devel \
		alsa-lib-devel \
		libffi-devel \
		autoconf \
		gcc-c++ \
		fontconfig-devel -y

	OPENJDK_JDK=$HOME/git/openjdk/jdk

	if [ -d $OPENJDK_JDK ]; then
		echo "We have the folder$OPENJDK_JDK"
		cd $OPENJDK_JDK
		git pull
	else
		echo "We do not have the folder$OPENJDK_JDK"
		mkdir -p $OPENJDK_JDK
		git clone https://github.com/openjdk/jdk.git $OPENJDK_JDK
		cd $OPENJDK_JDK
		git config pull.rebase false
	fi

	bash configure  --with-version-date=$(date +"%Y-%m-%d") --with-vendor-name=JarryDk

	echo ""
	echo "make clean images"
}

updateJdkAlternatives() {

    ALTERNATIVES_NAME=alternatives
    if [ -f /etc/redhat-release ]; then
        ALTERNATIVES_NAME=alternatives
    fi
    if [ -f /etc/lsb-release ]; then
	    ALTERNATIVES_NAME=update-alternatives
    fi

	echo "JAVA_HOME: $JAVA_HOME"

    sudo $ALTERNATIVES_NAME --install "/usr/bin/java" java "$JAVA_HOME/bin/java" 1
	sudo $ALTERNATIVES_NAME --set java "$JAVA_HOME/bin/java"

	if [ -f "$JAVA_HOME/bin/javac" ]; then
		sudo $ALTERNATIVES_NAME --install "/usr/bin/javac" javac "$JAVA_HOME/bin/javac" 1
		sudo $ALTERNATIVES_NAME --set javac "$JAVA_HOME/bin/javac"
	fi

	if [ -f "$JAVA_HOME/bin/javadoc" ]; then
		sudo $ALTERNATIVES_NAME --install "/usr/bin/javadoc" javadoc "$JAVA_HOME/bin/javadoc" 1
		sudo $ALTERNATIVES_NAME --set javadoc "$JAVA_HOME/bin/javadoc"
	fi

	if [ -f "$JAVA_HOME/bin/keytool" ]; then
		sudo $ALTERNATIVES_NAME --install "/usr/bin/keytool" keytool "$JAVA_HOME/bin/keytool" 1
		sudo $ALTERNATIVES_NAME --set keytool "$JAVA_HOME/bin/keytool"
	fi

}
